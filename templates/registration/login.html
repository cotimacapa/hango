{% extends "base.html" %}
{% load form_extras %}
{% block title %}Entrar - Hango{% endblock %}

{% block content %}
<div class="columns is-centered login-columns">
  <div class="column is-12-mobile is-6-tablet" style="max-width:380px;">
    <div class="box has-text-centered login-card">
      <h1 class="title is-4" style="margin-bottom:1rem;">Entrar</h1>

      {% if form.errors %}
        <div class="notification is-danger">Verifique seu usuário e senha.</div>
      {% endif %}

      <form method="post" action="{% url 'login' %}" novalidate>
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div class="field" style="margin-bottom:.9rem;">
          <div class="control">
            <input
              class="input login-input"
              type="text"
              name="{{ form.username.html_name }}"
              id="{{ form.username.id_for_label }}"
              value="{{ form.username.value|default_if_none:'' }}"
              placeholder="CPF"
              inputmode="numeric"
              pattern="[0-9]*"
              style="text-align:center"
              required>
          </div>
          {{ form.username.errors }}
        </div>

        <div class="field" style="margin-bottom:.9rem;">
          <div class="control">
            <input
              class="input login-input"
              type="password"
              name="{{ form.password.html_name }}"
              id="{{ form.password.id_for_label }}"
              placeholder="Senha"
              autocomplete="current-password"
              style="text-align:center"
              required>
          </div>
          {{ form.password.errors }}
        </div>

        <!-- Always send user through the post-login router -->
        <input type="hidden" name="next" value="{% url 'post_login_redirect' %}">

        <div class="field" style="margin-top:.25rem;">
          <button class="button is-primary login-button" type="submit">
            Entrar
          </button>
        </div>
      </form>

      <p class="is-size-7" style="margin-top:.9rem; line-height:1.35;">
        Não consegue entrar? Entre em contato com nossa equipe
        para receber uma senha temporária.
      </p>
    </div>
  </div>
</div>

<style>
  /* ---- Login page only: rock-solid centering on small screens ---- */
  @media (max-width: 768.98px){
    /* Kill Bulma's negative side gutters that nudge single columns */
    .login-columns { margin-left: 0 !important; margin-right: 0 !important; }
    .login-columns > .column {
      flex: 0 1 auto;
      width: 100%;
      max-width: 380px;
      margin-inline: auto; /* hard center */
    }
  }

  /* Keep the login card perfectly still (dark-mode global .box:hover sets translateY) */
  .login-card { transition: none !important; }
  .login-card,
  html[data-theme="dark"] .login-card:hover {
    transform: none !important;
  }

  /* Slight polish for inputs */
  .login-input { text-align: center; }

  /* Subtle placeholder that works in light/dark */
  .login-card .input::placeholder { opacity: 1; }

  /* Slightly smaller, centered submit button */
  .login-button {
    min-width: 9rem;
    height: 2.15rem;
    padding: 0 .9rem;
    font-size: 0.95rem;
  }
</style>
{% endblock %}
