{% extends 'base.html' %}
{% load static %}
{% block title %}Cardápio - Hango{% endblock %}

{% block content %}
  <h1 class="title">Cardápio de Hoje</h1>

  {# Badge with the next pickup date (if provided in context) #}
  {% if service_day %}
    <p class="pedido-dia">
      Pedido para dia <strong>{{ service_day|date:"j \\d\\e F" }}</strong>
    </p>
  {% endif %}

  {# Soft warning if student already has an order for that day #}
  {% if already_ordered_for_day %}
    <div class="notification is-warning is-light" style="margin-top:.25rem;">
      Você já possui um pedido para este dia.
    </div>
  {% endif %}

  {% with items_list=object_list|default:items %}
    {% if items_list %}
      <div class="columns is-multiline">
        {% for item in items_list %}
          <div class="column is-one-quarter">
            <div class="card">
              <div class="card-content">
                <p class="title is-5">{{ item.name }}</p>
                {% if item.description %}
                  <p class="subtitle is-7">{{ item.description }}</p>
                {% endif %}
                {% if item.category %}
                  <p class="subtitle is-6">{{ item.category }}</p>
                {% endif %}
              </div>
              <div class="card-content">
                <div class="buttons">
                  {% if already_ordered_for_day %}
                    <button class="button is-small is-primary" disabled title="Você já possui um pedido para este dia.">
                      Adicionar ao carrinho
                    </button>
                  {% else %}
                    <form method="post" action="{% url 'orders:add' item.id %}" style="display:inline">
                      {% csrf_token %}
                      <button type="submit" class="button is-small is-primary">
                        Adicionar ao carrinho
                      </button>
                    </form>
                  {% endif %}
                  <a href="{% url 'orders:cart' %}" class="button is-small is-light">
                    Ver carrinho
                  </a>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="has-text-grey">Nenhum item no cardápio ainda.</p>
    {% endif %}
  {% endwith %}

  <style>
    .pedido-dia {
      display: inline-block;
      font-size: .95rem;
      margin: .25rem 0 .75rem;
      padding: .35rem .6rem;
      border-radius: 999px;
      background: rgba(0,0,0,.06);
    }
    :root[data-theme="dark"] .pedido-dia {
      background: rgba(255,255,255,.08);
    }
  </style>
{% endblock %}
